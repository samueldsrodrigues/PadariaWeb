<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core">

<ui:composition template="/pages/template/template.xhtml">
	<ui:define name="body">
		<!-- Script -->
		<script type="text/javascript">
			$(window).bind("load", function() {
				select2();
				$("#dtResultados").datepicker();
				$("#dtResultados").mask("99/99/9999");
			});
		</script>
	
		<h:form prependId="false">
			<h:panelGroup id="painelDados" layout="block" styleClass="wrapper wraper-content" style="padding-top: 20px;" rendered="#{appBean.gestor or appBean.isUserRoot()}">
				<div class="row" style="padding-right: 15px; padding-left: 15px;">
					<h:selectOneMenu style="width: 20%; float: left;" styleClass="hidden-xs form-control m-b" value="#{appBean.loja}" converter="entityConverter">
						<f:selectItem itemLabel="[Selecione um Grupo de Lojas]" noSelectionOption="true" />
						<f:selectItems value="#{appBean.lojasGestor}" var="l" itemLabel="#{l.dsNome}" itemValue="#{l}" />
						<f:ajax listener="#{appBean.recalcularDados}" render="@form infSync"/>
					</h:selectOneMenu>
					
					<label class="col-lg-2 control-label" style="text-align: -moz-right; padding-top: 5px;">Data Consulta</label>
					<h:panelGroup styleClass="col-lg-2">
						<h:inputText id="dtResultados" value="#{appBean.dtResultados}" styleClass="form-control" converter="conversorData" />
					</h:panelGroup>
					
					<h:commandLink styleClass="btn hidden-xs btn-primary" style="float: right; margin-bottom: 15px;" action="#{appBean.recalcularDados}">
						<i class="fa fa-refresh" /> Atualizar
                    </h:commandLink>
                    
                    <!-- Mobile Design -->
                    <div class="hidden-sm hidden-md hidden-lg">
                    	 <h:selectOneMenu styleClass="m-b" style="width: 85%;" value="#{appBean.loja}" converter="entityConverter">
							<f:selectItems value="#{appBean.lojasGestor}" var="l" itemLabel="#{l.dsNome}" itemValue="#{l}" />
							<f:ajax render="@form" execute="@form" listener="#{appBean.recalcularDados}" event="change" />
						</h:selectOneMenu>
						 <h:commandLink styleClass="btn-xs btn-primary" style="float: right; margin-bottom: 15px;" action="#{appBean.recalcularDados}">
							<i class="fa fa-refresh" />
	                    </h:commandLink>
                    </div>
				</div>
				<div class="row">
					<div class="col-lg-3">
						<div class="ibox float-e-margins">
							<div class="ibox-title ">
								<span class="label label-success pull-right">Abertas</span>
								<h5>Qtd. Visitas Abertas</h5>
							</div>
							<div class="ibox-content">
								<h1 class="no-margins">#{appBean.qtdVisitasAbertas}</h1>
								<div class="hidden-xs hidden-sm stat-percent font-bold text-success">
									<h:commandLink action="#{appBean.detalhamentoDiarioVisitaAberta}">
										<i class="fa fa-search"></i>
									</h:commandLink>
								</div>
								<small>Quantidade de visitas abertas</small>
							</div>
						</div>
					</div>
					<div class="col-lg-3">
						<div class="ibox float-e-margins">
							<div class="ibox-title ">
								<span class="label label-info pull-right">Fechadas</span>
								<h5>Qtd. Visitas Fechadas</h5>
							</div>
							<div class="ibox-content">
								<h1 class="no-margins">#{appBean.qtdVisitasFechadas}</h1>
								<div class="hidden-xs hidden-sm stat-percent font-bold text-info">
									<h:commandLink
										action="#{appBean.detalhamentoDiarioVisitaFechadas}">
										<i class="fa fa-search"></i>
									</h:commandLink>
								</div>
								<small>Quantidade de visitas fechadas</small>
							</div>
						</div>
					</div>
					<div class="col-lg-3">
						<div class="ibox float-e-margins">
							<div class="ibox-title ">
								<span class="label label-warning pull-right">Total</span>
								<h5>Qtd. Total de Visitas</h5>
							</div>
							<div class="ibox-content">
								<h1 class="no-margins">#{appBean.totalQtdVisitas}</h1>

								<small>Quantidade total de visitas</small>
							</div>
						</div>
					</div>
					<div class="col-lg-3">
						<div class="ibox float-e-margins">
							<div class="ibox-title ">
								<span class="label label-danger pull-right">Total</span>
								<h5>Qtd. de Vendas</h5>
							</div>
							<div class="ibox-content">
								<h1 class="no-margins">#{appBean.qtdVendas}</h1>
								<div class="hidden-xs hidden-sm stat-percent font-bold text-danger">
									<h:commandLink>
										<i class="fa fa-search"></i>
									</h:commandLink>
								</div>
								<small>Quantidade de vendas</small>
							</div>
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-lg-4">
						<div class="ibox float-e-margins">
							<div class="ibox-title ">
								<span class="label label-success pull-right">R$</span>
								<h5>Total Recebido em Visitas</h5>
							</div>
							<div class="ibox-content">
								<h1 class="no-margins">
									R$
									<h:outputText value="#{appBean.totalValorVisita}">
										<f:convertNumber minFractionDigits="2" locale="pt_BR" />
									</h:outputText>
								</h1>
								<small>Total recebido em visitas</small>
							</div>
						</div>
					</div>
					<div class="col-lg-4">
						<div class="ibox float-e-margins">
							<div class="ibox-title ">
								<span class="label label-success pull-right">R$</span>
								<h5>Total recebido em Vendas</h5>
							</div>
							<div class="ibox-content">
								<h1 class="no-margins">
									R$
									<h:outputText value="#{appBean.totalValorVenda}">
										<f:convertNumber minFractionDigits="2" locale="pt_BR" />
									</h:outputText>
								</h1>

								<small>Total recebido em vendas</small>
							</div>
						</div>
					</div>
					<div class="col-lg-4">
						<div class="ibox float-e-margins">
							<div class="ibox-title ">
								<span class="label label-success pull-right">R$</span>
								<h5>Total Recebido</h5> 
							</div>
							<div class="ibox-content">
								<h1 class="no-margins">
									R$
									<h:outputText value="#{appBean.totalValorRecebido}">
										<f:convertNumber minFractionDigits="2" locale="pt_BR" />
									</h:outputText>
								</h1>

								<small>Total recebido</small>
							</div>
						</div>
					</div>
				</div>
				
				<!-- Mobile Design -->
				<div class="hidden-sm hidden-md hidden-lg">
					<h:panelGroup>
						<div class="text-left">
							<ul style="padding-left: 0px">
								Última Sincronização: #{appBean.lastSyncDate} - #{appBean.lastSyncHour}
							</ul>
						</div>
						<div class="text-left" style="padding-left: 0px;">
							Próxima Sincronização: #{appBean.loja.numMinSincronizacao} min
						</div>
					</h:panelGroup>
				</div>
			</h:panelGroup>
		</h:form>		
	</ui:define>
</ui:composition>
</html>